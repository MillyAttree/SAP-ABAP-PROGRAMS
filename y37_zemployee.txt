*&---------------------------------------------------------------------*
*& Report  Y37_ZEMPLOYEE
*&
*&---------------------------------------------------------------------*
*&
*&
*&---------------------------------------------------------------------*

REPORT  Y37_ZEMPLOYEE.

TABLES : VBRK, VBRP, KNA1.

TYPES: BEGIN OF TY_VBRK,
       VBELN LIKE VBRK-VBELN,
       FKDAT LIKE VBRK-FKDAT,
       FKART LIKE VBRK-FKART,
       KUNAG LIKE VBRK-KUNAG,
       END OF TY_VBRK.

DATA: IT_VBRK TYPE STANDARD TABLE OF TY_VBRK,
      WA_VBRK TYPE TY_VBRK.

TYPES: BEGIN OF TY_VBRP,
       VBELN LIKE VBRP-VBELN,
       WERKS LIKE VBRP-WERKS,
       KONDM LIKE VBRP-KONDM,
       FKIMG LIKE VBRP-FKIMG,
       NETWR LIKE VBRP-NETWR,
       UMVKZ LIKE VBRP-UMVKZ,
       END OF TY_VBRP.

DATA: IT_VBRP TYPE STANDARD TABLE OF TY_VBRP,
      WA_VBRP TYPE TY_VBRP.

TYPES: BEGIN OF TY_FIN,
      VBELN LIKE VBRK-VBELN,
      FKDAT LIKE VBRK-FKDAT,
      FKART LIKE VBRK-FKART,
      KUNAG LIKE VBRK-KUNAG,
      WERKS LIKE VBRP-WERKS,
      KONDM LIKE VBRP-KONDM,
      FKIMG LIKE VBRP-FKIMG,
      NETWR LIKE VBRP-NETWR,
      UMVKZ LIKE VBRP-UMVKZ,
      END OF TY_FIN.

DATA: IT_FIN TYPE STANDARD TABLE OF TY_FIN,
      WA_FIN TYPE TY_FIN.

SELECTION-SCREEN BEGIN OF BLOCK B1 WITH FRAME TITLE TEXT-001.
PARAMETERS : P_WERKS LIKE VBRP-WERKS.
SELECT-OPTIONS : S_FKDAT FOR VBRK-FKDAT.
SELECTION-SCREEN END OF BLOCK B1.

SELECT     VBELN
           FKDAT
           FKART
           KUNAG
    FROM VBRK INTO TABLE IT_VBRK WHERE FKDAT IN S_FKDAT ORDER BY fkdat.
    IF sy-subrc eq 0.
     sort it_vbrk by vbeln.
    ENDIF.

  IF IT_VBRK IS NOT INITIAL.
    SELECT  VBELN
            WERKS
            KONDM
            FKIMG
            NETWR
            UMVKZ
     FROM VBRP INTO TABLE IT_VBRP FOR ALL ENTRIES IN IT_VBRK WHERE VBELN = IT_VBRK-VBELN AND WERKS = P_WERKS.

     IF sy-subrc eq 0.
        sort it_vbrp by fkimg DESCENDING.
        DELETE it_vbrp FROM 11.
     ENDIF.

  ENDIF.

LOOP AT it_vbrp INTO wa_vbrp.

 WA_FIN-VBELN = WA_VBRP-VBELN.
    WA_FIN-KONDM = WA_VBRP-KONDM.
    WA_FIN-FKIMG = WA_VBRP-FKIMG.
    WA_FIN-NETWR = WA_VBRP-NETWR.
    WA_FIN-UMVKZ = WA_VBRP-UMVKZ.

    CLEAR WA_VBRK.
    READ TABLE IT_VBRK INTO WA_VBRK WITH KEY VBELN = WA_VBRP-VBELN.
    IF SY-SUBRC EQ 0.
      WA_FIN-FKDAT = WA_VBRK-FKDAT.
      WA_FIN-FKART = WA_VBRK-FKART.
      WA_FIN-KUNAG = WA_VBRK-KUNAG.
    ENDIF.

    APPEND WA_FIN TO IT_FIN.
    CLEAR WA_FIN.

ENDLOOP.






*tables: zemployees.
*
*data: BEGIN OF itab OCCURS 0,
*      EMPLOYEE like zEMPLOYEEs-EMPLOYEE,
*      department like zEMPLOYEEs-DEPARTMENT,
*      SALARY LIKE ZEMPLOYEES-SALARY,
*      END OF ITAB.
*
*
*SELECT * UP TO 2 ROWS INTO CORRESPONDING FIELDS OF TABLE ITAB FROM ZEMPLOYEES ORDER BY SALARY DESCENDING .
*
*
*   LOOP AT ITAB.
*    WRITE : ITAB-EMPLOYEE,
*            ITAB-DEPARTMENT,
*            ITAB-SALARY.
*  ENDLOOP.